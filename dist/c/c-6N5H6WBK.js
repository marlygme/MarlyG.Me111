import{a as t}from"dist/c/c-3HSCVK6T.js";import{a as o,b as p,c as r,d as w}from"dist/c/c-NDBQMNNS.js";import{a as h}from"dist/c/c-TOXB3UTS.js";import"dist/c/c-WMFIFJJA.js";import"dist/c/c-Z6WM42FE.js";import"dist/c/c-V4DUXOOY.js";import"dist/c/c-C4BDQY4F.js";import{a as e,b as u}from"dist/c/c-TMVCK6W7.js";import"dist/c/c-HHEBOSRR.js";import"dist/c/c-XROM67F3.js";import"dist/c/c-YDOAKQEQ.js";import"dist/c/c-Z5FS66WY.js";import"dist/c/c-SS3FIXRP.js";import"dist/c/c-UTITODNG.js";import"dist/c/c-QAFNK22T.js";import"dist/c/c-DVMYMT6O.js";import"dist/c/c-OL5TD5B5.js";import"dist/c/c-UFF2TEXX.js";import"dist/c/c-CNBRYZJZ.js";import"dist/c/c-PVKCUCIY.js";import"dist/c/c-OIX6SKCG.js";import"dist/c/c-CO6KMLVU.js";import"dist/c/c-ZPIGGSBD.js";import"dist/c/c-XZJ2VYXB.js";import"dist/c/c-TO5SHGYP.js";import"dist/c/c-CSO6RHYE.js";import"dist/c/c-66M2M7BF.js";import"dist/c/c-R2VSC7WL.js";import"dist/c/c-IKWSEEIB.js";import"dist/c/c-SJOEUML2.js";import{a as g}from"dist/c/c-B3GKQWCL.js";import"dist/c/c-7GZKL2AQ.js";import"dist/c/c-PGADEMPT.js";import"dist/c/c-47OO6S5B.js";import"dist/c/c-PYVZT23Z.js";import"dist/c/c-7F52ZL35.js";import"dist/c/c-XXWOGBXD.js";import"dist/c/c-UEQDAYP3.js";import"dist/c/c-7DM5WFG3.js";import"dist/c/c-U3IKFRJV.js";import"dist/c/c-4GHHNLLN.js";import"dist/c/c-IFNSVF3O.js";import"dist/c/c-QLZFYGE5.js";import"dist/c/c-HQKWHWGO.js";import"dist/c/c-6IAUXAGY.js";import"dist/c/c-JUWGGSMC.js";import"dist/c/c-PEZMTDKX.js";import{a as c}from"dist/c/c-I7NIUV5Z.js";import{b as a}from"dist/c/c-XIJYJD2D.js";import"dist/c/c-W3KEZFVF.js";import"dist/c/c-ZA64MI4Y.js";import{d as i}from"dist/c/c-4XCUMATV.js";var n=i(c()),s=i(a()),l=i(g());p();u();w();var m=t.extend({render:function(){return this.rendered=!0,this.template=h["template-viewer-widget-background"],this.setElement(this.template({data:this})),this.$el.prependTo(this.page.$fixedBgContainer),this.$picture=this.$(".picture-background"),this.$video=this.$(".video-background"),this.$videoContainer=this.$(".video-container"),this.$slideshow=this.$(".slideshow-container"),this.$slideshowPreload=this.$(".slideshow-preload"),this.picture&&this.selectedType==="picture"?this.renderPicture():!s.default.isEmpty(this.video)&&this.selectedType==="video"?this.renderVideo():this.slideshow&&this.selectedType==="slideshow"?this.renderSlideshow():this.widgetIsLoaded(),this},start:function(){return this.started=!0,this.selectedType==="video"&&!RM.screenshot&&this.rendered&&this.videoWidget&&!this.destroyed&&this.videoWidget.start(),this.selectedType==="slideshow"&&!RM.screenshot&&this.rendered&&!this.destroyed&&this.slideshowWidget&&!this.slideshowWidget.isAnimationRunning&&this.slideshowWidget.startAnimationLoop(),this},stop:function(){return this.started=!1,this.selectedType==="video"&&!RM.screenshot&&this.rendered&&this.videoWidget&&!this.destroyed&&this.videoWidget.stop(),this.selectedType==="slideshow"&&!RM.screenshot&&this.rendered&&!this.destroyed&&this.slideshowWidget&&this.slideshowWidget.isAnimationRunning&&this.slideshowWidget.stopAnimationLoop(),this},destroy:function(){return this.selectedType==="video"&&(this.videoWidget&&this.videoWidget.destroy(),this.videoWidget=null),this.selectedType==="slideshow"&&(this.slideshowWidget&&this.slideshowWidget.destroy(),this.slideshowWidget=null),t.prototype.destroy.apply(this,arguments)},hasVideoBG:function(){return!!(!RM.screenshot&&this.selectedType==="video"&&this.video&&this.video.url)},renderPicture:function(){if(!this.picture){this.widgetIsLoaded();return}let d=e.useLambdaUrl(this.picture)||e.useLambdaUrlOldProjects(this.picture,"background")?e.getLambdaUrl(this.picture):this.picture.finalUrl||this.picture.effectUrl||this.picture.unscaledOptimizedUrl||this.picture.url;(0,n.default)("<img/>").on("load",s.default.bind(function(){this.$picture.css({"background-image":"url("+d+")"}),RM.screenshot?setTimeout(this.widgetIsLoaded,200):this.widgetIsLoaded()},this)).on("error",this.widgetIsLoaded).attr("src",d)},renderSlideshow:function(){this.slideshowWidget=new o({data:this.slideshow,container:this.$slideshow,preloadContainer:this.$slideshowPreload,name:this.page.cid}),RM.screenshot?(this.slideshowWidget.render(),this.slideshowWidget.on("loaded",function(){this.widgetIsLoaded()}.bind(this))):(this.slideshowWidget.render(!this.page.isCurrent()),this.widgetIsLoaded())},renderVideo:function(){this.videoWidget=new r({el:this.$videoContainer.get(0),model:new l.default.Model({video:this.video}),attributes:{thumbnailMode:window.RM.screenshot}}),this.videoWidget.on("loaded",()=>{this.widgetIsLoaded()}),this.videoWidget.on("playStarted",()=>{this.trigger("videoBGStarted")}),this.videoWidget.render()}}),b=m;export{b as default};
